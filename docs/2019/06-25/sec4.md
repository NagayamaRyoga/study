# 4. Analysis

現在、Hydanはメッセージを埋め込む際に命令の統計分布を尊重していないが、命令の分布に偏りがあると秘密情報を簡単に検出できるため、これらの命令が"wild"に分布しているかを調べることは興味深い。

いくつかのOSで実行可能ファイル内の等価な各命令数を分析した。
次に、各命令の分布と各集合の分布を計算した。
OpenBSDに関する結果をAppendix Aに示す。

データを見ると、すべての命令が均等に生成されていないことがわかる。
実際には、各命令集合のうちどれか1つが圧倒的に多く存在している。
したがって、メッセージのサイズが大きくなるにつれてHydanによって情報が埋め込まれたことを検出するのは容易になる。

いくつかのコンパイラは`.comment`タグに(コンパイラに関する)情報を埋め込むので、攻撃者が分布を予想しやすくなる。

Hydanの検出を困難にするには、なにかしらかの制限を設けなければならないだろう。
符号化できる情報量が各集合のもっとも稀有な命令の出現頻度を超えることができないため、符号化率が大幅に低下する。
例えば、OpenBSDでは (約 1/110 から) 1/5099 になる。
ほかのOSの場合は Table 2 に示す。

```
     OS     | Original Encoding Rate | Stealthy Encoding Rate | KB per bit |
------------+------------------------+------------------------+------------+
   OpenBSD  |           1/106        |            1/5099      |      66.0  |
   FreeBSD  |           1/104        |            1/4823      |      61.2  |
   NetBSD   |           1/ 95        |            1/ 846      |       9.81 |
 Windows XP |           1/137        |            1/  74      |       1.24 |
------------+------------------------+------------------------+------------+
```

明らかに、命令置換だけで大量のデータを密かに埋め込むのは不可能である。
しかし、鍵や署名などの短いメッセージを埋め込むことは特にNetBSDやLinux、Windows XPの場合には依然として可能である。

Section 5では、符号化プロセスの秘密性を改善するためのいくつかの技術について述べる。
