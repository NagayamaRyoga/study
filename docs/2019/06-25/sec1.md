# Abstract

我々はx86プログラムのバイナリに情報を埋め込むための、ステガノグラフィ方式を提案する。

**機能的に等価な命令の集合** を定義し、鍵から導かれた選択プロセスで割り当てる命令をそれぞれの集合から選択することで情報を機械語に符号化する。
このような方式は電子透かしやフィンガープリント、実行可能ファイルへの署名、もしくは単に変換を行う通信チャネルの作成に用いることができる。

我々は *分布を決定する*(determining the distributions) ことで通信チャネルの容量を実験的に測定した。

分析の結果、各実行可能ファイルには限られた量の情報 (符号化率は約1/110) しか埋め込むことができないが、これは前述の用途に用いるには十分な量である。

チャネル容量の改善が今後の課題である。

# 1. Introduction

従来の情報隠蔽技術は画像や音声、動画の内部に補助的な情報を符号化する。

それらの典型的な手法はユーザが気が付かないように、媒体内の冗長bitを使って埋め込みを行う。
"冗長性"の定義は媒体に依存する。

それらの 侵入性(invasive nature) のために、情報隠蔽システムはしばしば検出が容易ですが、パターンを隠蔽するための試みも行われてきた[[1]](#bib-1)。

現代のステガノグラフィでは、秘密鍵は "埋め込まれる情報の暗号化" と "符号化プロセスでの冗長bitの選択" の両方で使用される。

目的は、攻撃者が秘密情報の存在を検出するのを困難にすることである。
これは媒体の容量が、多くの冗長bitを無視しても情報を符号化できる程度に大きい場合のみ実用的である。

秘密通信におけるその使用とは別に、情報隠蔽プロセス[2]は電子透かしやフィンガープリンティングに使え、それによってデータの特性 (そのソース、購入したユーザ、制御権限などの情報) をデータそれ自体の中に符号化できる。

<!-- textlint-disable preset-japanese/no-doubled-joshi -->
"秘密の"情報はそれを取り除くとデータが破損し使用不能になる (音声ファイルにノイズが入るなど) よう符号化され、そのような方式はある程度成功している。
<!-- textlint-enable preset-japanese/no-doubled-joshi -->

この論文では、任意のプログラムバイナリに対して情報隠蔽技術の適用について述べる。
我々のシステム

Hydanと名付けられたこのシステムでは、**機能的に等価な命令の集合** を用いて情報を埋め込む。

利用可能な容量を推定するために、複数のOSディストリビューション (OpenBSD 3.4, FreeBSD 4.4, NetBSD 1.6.1, Red Hat Linux 9, and Windows XP Professional) のバイナリを調べた。

我々のテストは、現在使用している等価な命令の集合のもとで有効な情報容量が約1/110 bitであることを示している。(すなわち、110bitのプログラムコードにつき1bitの情報を符号化出来る。)
ただし、プログラム全体のサイズとコードサイズは区別されることに注意しなければならない。
プログラム全体のサイズにはコードサイズに加えて、様々なデータ、リロケーション情報、BSSセクションを含む。

> 注釈: BSSは0で初期化された静的な変数の確保される領域。
>
> Block Started by Symbolというアセンブラの疑似命令に由来する。

実験的に、コードセクションは実行可能ファイルの合計サイズの75%を占めることがわかった。
例えば、210KBの静的にリンクされた実行可能ファイルは約158KBのコードを含み、1.44KB (11,766 bit) のデータを埋め込むことができる。

対して、Outguess[[1]](#bib-1) のようなその他のツールは画像への 1/17 bitの符号化率を達成しているため、データレートが重要な変換通信に適している。

現在のバージョンのHydanで達成されている1/110の符号化率は、命令置換のみを使用したときに得られるものである。
Section 5では、符号化率を1/36に改善できる可能性のある策について述べる。

この容量はステガノグラフィック変換チャネルとして、実行可能ファイルへの透かしやフィンガープリンティング、もしくは電子署名に利用できる。

これは、すべてが0の値で符号化してからそこに署名を上書きすることで実行可能ファイルの機能を損なうことなく符号化できる。
署名の検証は、単純にバイナリから署名を抽出し、すべてが0のパターンで上書きしてから最後に検証を行う。
この署名は、公開鍵・秘密鍵を使用した方式 (MAC) にできる。

情報が隠蔽されているということとは別に、この手法の利点は実行ファイルのサイズが変更されないことである。
従ってプログラムのサイズを大きくすることなく、外部のハッシュデータベースを利用しない、プログラムの機能的完全性の保護を提供するファイルシステムに対して特に魅力的である。

## 本紙の構成

Section 2 では古典的ステガノグラフィとコードステガノグラフィについて検証する。

Section 3 では提案手法について述べ、Section 4 で多数のプログラムのバイナリについてその容量を実験的に測定する。

Section 5 では、提案手法の欠点とそれを克服するための潜在的な方法について述べる。
