### 5. A Software Watermark Embedding and Recognition System

我々は上記の概念をもとにシステムモデルを設計した。

埋め込みサブシステム:

任意の $P \in \bf{P}$ と 任意の $W \in \bf{W}$ について、

**Step 1:** $P$ に関する干渉グラフ $G$ を構築する。

**Step 2:** QPアルゴリズムを用いて透かし $W$ をグラフ $G$ に埋め込み、透かし入りグラフ $G'$ を得る。

**Step 3:** G' が新しいプログラムの干渉グラフになるように、$P$ 内のいくつかの変数の干渉関係を確立する。

認識サブシステム:

任意の $P \in \bf{P}$ について、

**Step 1:** $P, P'$ の干渉グラフ $G, G'$ を構築する。

**Step 2:** QP認識アルゴリズムを用いて、グラフ $G$ と $G'$ の透かし $W$ を認識する。
