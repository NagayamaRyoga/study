# Provable Security - 証明可能安全性

暗号システムを設計するときには **証明可能安全** (_provably secure_) であることが望ましい。

**証明可能安全**とは、暗号システムがある種の攻撃を防げることを数学的に証明出来ることを言う。

この分野の先駆けとなる研究は _C.E. Shannon_ によって行われた。

_Shannon_ は メッセージに関連する情報の量 (the amount of information associated with a message) と 完全秘密 (perfect secrecy) という概念を初めて導入した。

完全秘密暗号 (_perfect secret_ cipher) はあらゆる暗号文単独攻撃を完璧に防ぐ。
攻撃者は、例えマシンパワーと時間を無制限に使えたとしても平文に関する一切の情報を得られない。

_Vernam_ の **ワンタイムパッド** (_one time pad_) (Section 2.1.1.) は、メッセージを完全にランダムなビット列とビット単位に XOR をとって暗号化するもので、最も有名な完全秘密暗号だ。

ワンタイムパッドは上のような受動的攻撃にさえ完全に耐える。

この安全性はシャノンの理論によって数学的に証明されている。

古典的な情報理論的安全性 (information-theoretic security) については Section 9.1. で論じる。

_Shannon_ の情報理論については Appendix B を参照せよ。

あいにくと _Vernam_ のワンタイムパッドを含む全ての完全秘密暗号は非実用的だ。

完全秘密に十分な長さの真にランダムなビット列を生成して処理することは非現実的だ。

従って、近年の証明可能安全へのアプローチは、完全秘密への理想と非現実的な無限のマシンパワーの仮定を放棄する。
そのため、アルゴリズムに関する計算の複雑さも考慮しなければならない。

実際に 可能な (_feasible_) 攻撃のみが考慮される。

**可能** であるとは、攻撃が効率的なアルゴリズムによって実現されることを意味する。

当然のように、ここで効率の概念についての疑問が生じる。

確かに、非多項式実行時間であるアルゴリズムは効率的でない。

逆に、多項式実行時間のアルゴリズムは大抵効率的だと見做される。

暗号化手法に対する攻撃はランダムな出来事の影響を受けることもある。

攻撃者 _Eve_ が次にどんな攻撃をするかコイントスで決めるかもしれない。
そのため、**確率的アルゴリズム** (_probabilistic algorithms_) は、攻撃者をモデル化するために使われる。

例えば暗号文単独攻撃によって暗号システムが破られるということは、多項式実行時間を有する確率的アルゴリズムが無視できないほどの確率で、暗号文から平文に関する情報を導き出せることを意味する。

確率的アルゴリズムは少なくとも部分的なランダム性に依るところがあるが、それを非決定論的アルゴリズムと混同してはいけない。

確率的多項式実行時間アルゴリズムの概念と、その根底にある確率的モデルについては Chapter 5. で論じる。

公開鍵暗号システムの安全性は、計算の困難さ (問題解決のための効率的な解法が存在しないこと) に基づいている。

例えば、RSA法の秘密鍵は巨大な整数 (現在のマシンパワーでは1024bitくらい) の素因数を計算することが可能であれば容易に求めることが出来る。

しかしながら、巨大な整数の素因数分解は不可能と見做されている。

公開鍵暗号システムの計算上の攻撃に対する堅牢さは数学的に証明されているものではない。

従って、公開鍵暗号方式の安全性の根拠は常に条件付きであり、基礎となる仮定が妥当であることに依存する。

公開鍵暗号方式の仮定は通常ある関数 $f$ が一方向、すなわちある$x$ について効率的に $f(x)$ を計算出来るが、$f(x')$ から $x'$ の値を求められない、としている。

これらの仮定は、一方向関数の概念と同様に、確率的多項式アルゴリズムを使うことで非常に正確にすることが出来る。

> These assumptions, as well as the notion of a one-way function, can be made very precise by the use of probabilistic polynomial algorithms.

確率的多項式アルゴリズムによってうまく関数を逆変換される確率は 無視できるほど小さい (_negligibly small_)。(Chapter 6., Definition 6.12.)

本書には因数分解、離散対数、二次的残差仮説 (quadratic resduosity assumptions) などの重要な例が含まれている。(Chapter 6.)

_Shannon_ の完全秘密には、**平文識別不能性** (_ciphertext indistinguishability_) (あるいは **意味論的安全性** (_semantic security_)) がある。

攻撃者の計算量に関わらず、攻撃者が2つの平文 $m$ と $m'$ の区別がつかない場合に限り、暗号は完全秘密である。
攻撃者が暗号文 $c$ が $m$、$m'$ の暗号化であることを知っていれば $1/2$ の確率で正しいほうを選択する。

平文識別不能性 (**計算量的識別不能性** (_polynomial-time indistinguishability_)) は、攻撃者が正しい確率的多項式アルゴリズムを適用させる確率が精々 $1/2$ よりもほんのわずかに大きい程度であることを意味する。(Chapter 9, Definition 9.14.)

Section 9.4. では **公開鍵ワンタイムパッド** (_public-key one-time pads_) は識別不能であることが証明されている。

これは、例えば、RSA公開鍵ワンタイムパッドはRSA関数が一方向であるという唯一の仮定のもとで平文識別不能であることを意味する。

公開鍵ワンタイムパッドは、_Vernam_ のワンタイムパッドに似ている。
相違点は、メッセージ $m$ が一方向関数によって短い真にランダムなシード値から生成された疑似乱数bit列とXORをとる点だ。

このことからわかるように、一方向関数は公開鍵暗号とデジタル署名のみでなく、計算上完全な疑似乱数生成器にとっても不可欠な要素だ。 (Chapter 8.)

$f$ が一方向関数である場合、$f(x)$ から $x$ を求めることが不可能であるだけでなく、$x$ の特定のbit (ハードコアビット (_hard-core bit_)) についても同様に推測をするのが困難だ。

この特性は、一方向関数のビット安全性 (_the bit security of a one-way function_) と呼ばれる。

例えば、最下位ビットは RSA関数 $x \mapsto x^e \; \rm{mod}$ $n$ のハードコアビットだ。

真にランダムなシード値から繰り返し $f$ を適用し、その毎にハードコアビット列をとると、疑似乱数bit列が得られる。

これらのbit列と真にランダムなbit列を効率的なアルゴリズムで識別することは出来ない。
また、同様に前のbitから次のbitを予測することは事実上不可能である。(ヤオの定理 (_Yao's Theorem_)、Section 8.2.)
そのため、これらは計算上完全である。

重要な一方向関数のビット安全性については Chapter 7. で確率に関する詳細な分析を含めて検証されている。

ランダム性と暗号化戦略の安全性は密接に関係している。

ランダム性の存在しない安全性はない。

暗号文が攻撃者に対しランダムに現れる場合にのみ暗号化手法は秘密を提供する。

> An encryption method provides secrecy only if the ciphertexts appear random to the adversary Eve.
