# 1. Introduction

ソフトウェアの著作権侵害は、現在のコンピュータソフトウェア業界にとって深刻な課題である。
Business Software Alliance (BSA) が発表した2016年のGlobal PC Software Piracy Research Reportでは、2015年の世界のソフトウェア海賊行為は39%に達し、経済的損失は約522億ドルに達すると指摘されている[1]。
ソフトウェア透かしは開発者、発行者、所有者、ユーザ、その他の情報をソフトウェアに埋め込むことで、正規の所有者と違法な利用者を識別するための著作権保護技術である。

ソフトウェア透かしは静的なものと動的なものに分類される[2]。

静的透かしでは、埋め込み対象のプログラムは静的オブジェクトとみなされ、透かしは静的なデータあるいはコードに埋め込まれる。
静的透かしに関する先行研究には以下のようなものがある。

- コード置換[3]
- 基本ブロックの並べ替え[4]
- レジスタ割当[5]
- 不透過述語[6]
- グラフ符号化[7]
- Javaメソッド名符号化[8]
- Androidアプリケーションに対する透かしの実装と再パッケージ化の妨害[9]

これらの透かし手法は、透かしの生成の柔軟さと実装の単純さのために広く用いられている。
しかし、これらの透かしは発見と削除が容易である。

一方で動的透かしの場合、プログラムは動的なオブジェクトとみなされ、透かしは実行時の中間状態として埋め込まれる。
その特徴は、ソフトウェアの「パフォーマンス」を最大化する。
本研究では静的透かしよりもロバストな動的透かしに焦点を当てる。
動的透かしは主に3つに分類される。

- イースターエッグ透かし[10][11][12]

    秘密の入力に対し、透かし情報を表示する。

- データ構造透かし[13]

    これらの手法はプログラムの実行中にスタックデータ構造から、埋め込まれた透かしを抽出する。

    - K-number符号化[14]
    - 順列小符号化[15]
    - PPCT符号化を用いた動的透かしアルゴリズム[16]。

- 操作状態透かし[17]

    - ROP (return-oriented proggramming) ベースの手法[18]
    - バッファオーバフローベースの手法[2]

        プログラムにバッファオーバフロー脆弱性を必要とし、特別な入力でバッファオーバフローをトリガーすることで透かしを抽出する。

    - 制御フロー難読化ベースのアルゴリズム[19]

        透かしをニューラルネットワークモジュールに埋め込む。これはプログラムの制御フローを混乱させるためにも用いられる。

<!-- textlint-disable -->
これらの動的透かしはプログラムの実行に基づいて埋め込みと抽出を行う。
これらの手法は他の種類のアルゴリズムよりも隠蔽性と堅牢性に優れていることが証明されている。
しかしほとんどの手法について、対象のプログラムと透かしは比較的独立しているため、透かしは加算攻撃や減算攻撃に対して弱くなる。
これを改善するため、我々は高いステルス性と強力な攻撃防止機能を備えた例外処理ベースの動的ソフトウェア透かしを提案する。
このアルゴリズムは、通常のプログラムの動作を保証するため、削除の困難な例外処理がプログラムに存在するという事実を前提とする。
<!-- textlint-enable -->

1. 埋め込まれる透かしスクランブル符号化に対応した例外型の列にしたがって例外型テーブルが作成される
2. 対応するトリガー条件と例外ハンドラが構築され、秘密の入力を用いて透かしの埋め込み可能な点を取得する
3. 構築されたトリガー条件と例外ハンドラのコード片が、注意深く設計されたいくつの識別子とともにプログラムに挿入する

秘密の入力のもとでプログラムを実行することで、挿入された識別子を用いてトリガーされた例外型を抽出する。
例外型と透かし間のマッピングを用いて透かしをデコードする。
このアルゴリズムは例外型の配列として透かしを符号化する。これはソースコードと密接に組み合わされて埋め込まれ、実行可能コードから直接抽出される。
結果、透かしのステルス性とロバスト性が大幅に向上する。
