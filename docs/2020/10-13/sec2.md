# 2. Literature Survey

ソフトウェア透かしは、アプローチと出版物の種類に基づいて様々な方法で分類できる (表1)。
過去23年間 (1996年〜2018年) のソフトウェア透かしに関する研究を表2にまとめる。

**表1: 論文中の表記**

|セクション|形式 (略)|
|:-------|:--------------------|
|アプローチ|Path/branch (PB)<br> reodering (RB)<br> obfuscation (OB)<br> chaos (CB)<br> graph theoretic (GT)<br> opaque predicate (OP)<br> other methods (OT)|
|発表形式|Tool (T)<br> Survey (SV)<br> Reserch (R)<br> Comparative study (CS)|

**表2: ソフトウェア透かしに関する調査**

(省略)


## Reordering-Based Approach

ソフトウェア透かしは Davidson と Myhrvold (1996) によって提案された。
彼らは基本ブロックに透かしを符号化するアルゴリズムを提案した。

Shirali-Shahreza と Shirali-Shahreza (2008) は命令順序の変更によるソフトウェア透かし手法を提案した。
方程式のオペランドを、出力を維持するように透かしに基づいて変更する。
Sha ら (2009) はオペランドの係数の並び替えに基づいてよく似た方法を提案した。
Sha ら (2009) の手法は Shirali-Shahreza と Shirali-Shahreza (2008) の方法と比較して優れている。

Hamilton と Danicic (2011) はコードの並び替えによるソフトウェア透かしに関する調査を発表した。
その後、Sharma ら (2012) は関数従属性指向シーケンス (FDOS) にを用いて方程式を並び替える構造プログラミング用の静的透かし手法を提案した。
数学的にオペランドを交換し、次に非論理的な依存関係を持つ相互に独立した関数へ順序付けを課す。

並び替えに基づく透かしはセマンティックを保つ変換攻撃の影響をとても受けやすい。


## Graph Theoretic‑Based Approach

何人かの研究者はグラフ理論的アプローチを用いたソフトウェア透かし手法を提案した。

1998年、Qu と Potkonjak (1998) はレジスタ割当を用いて透かしを埋め込む手法を提案した。
QPアルゴリズム (Qu と Potkonjak (1998) によって名付けられた) は、グラフ彩色の概念を応用した制約ベースの透かしアルゴリズムである。

Qu と Potkonjak (2000) は彼らの先行研究 (Qu と Potkonjak (1998)) に基づいたフィンガープリント技術を提案した。
QPアルゴリズムは透かしの値に基づいてグラフに辺を追加し、その変更されたグラフを用いてプログラム中の変数間の相互作用をキャプチャする。
彼らは一方向関数を導入し (Qu と Potkonjak 1999)、一方向暗号化関数をメッセージに適用すると、意味のあるメッセージの構築が困難になると主張している。

2004年、Myles と Collberg (2004) は Qu と Potkonjak (1998) に基づいて SANDMARK (Collberg ら 2003b) で新たなQPSアルゴリズムを提案した。
QPSはデータレートが高く、一方で難読化ベースの攻撃などの様々な攻撃を受けやすい傾向にある。

2006年、Zhu と Thomborson (2006b) は透かしを抽出するために元の透かし入りグラフを用いた実際の推論グラフを必要とするQPIという名前のQPアルゴリズムの修正版について述べた。
その後、 (Jiang ら 2009) はQPIと公開鍵暗号を組み合わせた手法を提案した。
彼らは透かしを埋め込む前に暗号化した。

1999年、Collberg らはプログラムの実行中にグラフを生成する動的透かし手法を提案した (Collberg と Thomborson 1999)。
彼らのアプローチに基づき、Krishnaswamy ら (2000) は動的データ構造に透かしを埋め込む手法を提案した。
Krishnaswamy らは Collberg と Thomborson 1999 に基づき、Javaプログラムに透かしを埋め込むための最初の実用的なツールである JavaWiz を開発した。

攻撃者はセマンティクス保存技術によりダミーデータ構造を用意に除去できるため、様々なデータ構造に透かしを埋め込むことは減算攻撃の影響を受けやすい。

Kamel と Albluwi (2009) は R-tree データ構造とその変種に基づいた透かし手法を提案した。
R-tree は保存されたオブジェクトのエントリの順序を用いて冗長性を内部的に維持する。

Venkatesan ら (2001) は透かしの値を格納する特別にマークされたノードを追加することで、CFGの変更に基づいた透かし手法を提案した。
この手法は耐タンパ性の問題を解決することにも適している。
Collberg ら (2009) は Venkatesan ら (2001) によって提案された GTW (Graph-Theoretic Watermarking) アルゴリズムを実装した。

2008年には、Collberg と Thomborson (1999) の弱点をカバーできる閾値ベースの手法が Luo ら (2008) によって提案されている。
その後、Collberg ら (2003a) は2つのグラフベース透かしアルゴリズム (Collberg と Thomborson 1999) と (Venkatesan ら 2001) に焦点を当てている。
その研究によると、Reducible Permutation Graph (RPG) と Planted Planar Cubic trees (PPCTs) がもっとも高い潜在能力を持っている (Collberg ら 2003a)。
PPCTはルートを除いた全てのノードの次数が2の二分木である。
PPCT は耐タンパ定数符号 (Thomborson ら 2004) で値を表現するために用いられる。
PPCTグラフは他のグラフ理論技術に比べビットレートが低く、一方で復元力が高い。

Collberg と Thomborson (1999) は透かしを数値で表現し、グラフトポロジで符号化した。
このトポロジには Radix や 改良PPCT のような構造を用いてもよい。
Krishnaswamy ら (2000) は透かし整数とPPCT構造の関係について述べた。
しかし、透かしとして使用される巨大な整数の表現には失敗している。
そのため、Yong と Yixian (2004) では、radix の視点でPPCTを改良した改良PPCTが提案されている。

He (2002) は動的グラフ透かしシステムに定数符号技術がどのように含まれるかを説明した (He 2002)。

Mishra ら (2008) は Venkatesan ら (2001) が提案した手法とほぼ同様の手法で、Javaクラスのプログラム全体に透かしを埋め込む手法を提案した。
この手法の唯一の違いは、Venkatesan ら (2001) ではコードセグメントに透かしを埋め込んでいるのに対して Mishra ら (2008) の手法ではそれを行っていないことである。

Chan ら (2013) では、JavaScriptプログラム上でのヒープグラフベースのソフトウェアバースマーク技術が用いられている。
彼らは、プログラムと電子透かしの間の意味レベルの統合の欠如が動的透かしの大きな問題であると指摘している。
その後、Chen ら (2017b) は動的なソフトウェア透かしフレームワークを構築するために、制御フロー難読化を導入した。
透かしはいくつかの断片に分割され、各断片は難読化された各分岐に格納する。
興味深いことに、制御フロー難読化は、難読化された分岐を内部プログラムのロジックへ関連付けられた隠された実行パスに接続する。

2015年、Tian ら (2015) はソフトウェアバースマークのための動的キー命令列に基づく手法を開発した。
この命令列は、実行可能コードから抽出でき、コンパイラの最適化や難読化攻撃に耐性を持つ。

別の手法 (Chen ら 2017a) は、Javaのリフレクションを用いて透かしを符号化するために使用されるメソッド名を見つける。

1999年、Pieprzyk (1999) は 分類されたソフトウェアの同一性に関する著作権保護の問題を解決するため、著作権フィンガープリントを用いた。
Collberg ら (2007) によって提案された動的フィンガープリント手法はプログラムの実行中のグラフ内部に埋め込まれる。
これは静的なフィンガープリントと比較して難読化や最適化により耐性を持つ (Collberg ら 2007)。

2010年、Chroni と Nikolopoulos (2010) は電子透かしの整数を self-inverted permutations (SIP) として符号化するアルゴリズムを提案した。
このアルゴリズムは、ある数値をSIPに変換し、SIPから再び数値に変換する処理を O(n) 時間で行う。
また、著者らはSIPを介して透かし整数をグラフに変換する方法も提案している (Chroni と Nikolopoulos 2011b)。
これに基づいて Chroni と Nikolopoulos (2012b) は数値をRPGとして符号化するための効率的な手法を提案した (Chroni と Nikolopoulos 2010)。
その後、透かしグラフを特定の関数を用いてアプリケーションプログラムに埋め込む手法を拡張した (Chroni と Nikolopoulos 2012a)。

Bentoa ら (2014) は、符号化手法やアルゴリズムなどに基づいて、伝統的なRPGの特徴を特徴づけた (Bentoa ら 2014)。
その後 Chionis ら (2013b) は、アプリケ0ションにRPGを用いた動的透かし手法を提案した。
