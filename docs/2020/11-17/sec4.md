# 4. The Analysis of CRSW

本節ではCRSWのロバスト性とパフォーマンスの低下について論じる。

\(W\)、\(C_m\)、\(C_a\) および \(C_d\) の長さをそれぞれ \(n\) byte、 \(l_m\) byte、\(l_a\) byte、\(l_d\) byteとする。

**ロバスト性**

まず、ロバスト性について考える。

\(R\[[P\]]\) をプログラム \(P\) のセマンティクス、\(\omega \in \Gamma_b = \{\phi \| R\[[\phi(P)\]]\} = R\[[P\]]\) を意味保存変換とする。
CRSWの場合、可視化出力 \(V_\widetilde{W}\) のため、\(R\[[V_\widetilde{W}\]] \subseteq R\[[P'\]]\) が保たれる。
また、意味保存変換の定義に従って以下の関係が成り立つ。

\[
    R\[[V_{\widetilde{W}}\]] \subseteq R\[[P'\]]= R\[[\omega(P)\]] \tag{6}
\]

<!-- textlint-disable -->
式(6) は、意味保存変換は \(V_{\widetilde{W}}\) のセマンティクスを破壊できず、また、CRSWは \(R\[[V_{\widetilde{W}}\]]\) と \(R\[[P\]]\) を区別できるような攻撃を除けば意味保存変換に対して \(V_{\widetilde{W}}\) が耐性を持つことを意味する。
<!-- textlint-enable -->

アンチリバースエンジニアリングモジュールでは、リバースエンジニアリング攻撃を阻止するため、アンチ静的解析手法とアンチ動的デバッグ手法を用いる。
リバースエンジニアリングに対する耐性の評価は、CRSWで用いるアンチリバースエンジニアリング手法に依存する。
さらに、透かしはカオス分散符号化によってプログラムのコードに埋め込まれる。
そのため、命令とデータを組み合わせることによって静的解析への解析をより困難にできる。

カオス分散符号化を用いているため、敵対者がコードの任意の部分のみを再利用しようとすると、透かしがプログラムを失敗させてしまう。
\(W'\) は \(C_m\)、\(C_d\) および \(C_a\) によって置き換えられたコードを除く、全体に均一に分散されるため、平均して \(\frac{l-l_m-l_d-l_a}{n}\) バイトのコードあたり1バイトの透かしが含まれている。
そのため、再利用可能なコードの平均長 \(l_v\) は

\[
    l_v = \frac{l-l_m-l_d-l_a}{n}
\]

となる。
